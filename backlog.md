perf: attempt to scan the tree the minimum possible times